stacks: [support]
regions: [eu-west-1]
allowedStages:
  - CODE
  - PROD
deployments:
  cfn:
    type: cloud-formation
    app: workers
    parameters:
      templateStagePaths:
        CODE: SupportWorkers-CODE.template.json
        PROD: SupportWorkers-API-PROD.template.json
  support-workers:
    type: aws-lambda
    parameters:
      bucketSSMKey: /account/services/support-workers.artifact.bucket
      functionNames:
        - "-CreatePaymentMethodLambda-"
        - "-CreateSalesforceContactLambda-"
        - "-CreateZuoraSubscriptionLambda-"
        - "-SendThankYouEmailLambda-"
        - "-UpdateSupporterProductDataLambda-"
        - "-FailureHandlerLambda-"
        - "-SendAcquisitionEventLambda-"
        - "-PreparePaymentMethodForReuseLambda-"
      fileName: support-workers.jar
    dependencies: [cfn]
  it-tests:
    type: aws-s3
    parameters:
      bucketSSMKey: /account/services/support-workers.artifact.bucket
      cacheControl: private
      publicReadAcl: false
